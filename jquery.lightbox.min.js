!function(e){e.fn.lightbox=function(t){var a=e.extend({},e.fn.lightbox.defaults,t);function o(){var t,o,g,s;return e(window).on("orientationchange",n),e(window).on("resize",n),e("#overlay").remove(),e("#lightbox").remove(),a.inprogress=!1,a.video=!1,a.auto=-1,g='<div id="outerImageContainer"><div id="imageContainer"><video id="lightboxVideo" style="display: none; width: 100%"></video><img id="lightboxImage"><div id="hoverNav"><a href="javascript://" title="'+(o=a.strings).prevLinkTitle+'" id="prevLink"></a><a href="javascript://" id="nextLink" title="'+o.nextLinkTitle+'"></a></div><div id="jqlb_loading"><a href="javascript://" id="loadingLink"><div id="jqlb_spinner"></div></a></div></div></div>',s='<div id="imageDataContainer" class="clearfix"><div id="imageData"><div id="imageDetails"><span id="titleAndCaption"></span><div id="controls"><span id="numberDisplay"></span> <a id="playPause" href="#"></a> <span id="downloadLink"></span></div></div><div id="bottomNav">',s+='<a href="javascript://" id="bottomNavClose" title="'+o.closeTitle+'"><div id="jqlb_closelabel"></div></a></div></div></div>',a.navbarOnTop?(t='<div id="overlay"></div><div id="lightbox">'+s+g+"</div>",e("body").append(t),e("#imageDataContainer").addClass("ontop")):(t='<div id="overlay"></div><div id="lightbox">'+g+s+"</div>",e("body").append(t)),e("#overlay").on("click",function(){c()}).hide(),e("#lightbox").on("click",function(){c()}).hide(),e("#loadingLink").on("click",function(){return c(),!1}),e("#bottomNavClose").on("click",function(){return c(),!1}),e("#outerImageContainer").width(a.widthCurrent).height(a.heightCurrent),e("#imageDataContainer").width(a.widthCurrent),a.imageClickClose||(e("#lightboxImage").on("click",function(){return!1}),e("#hoverNav").on("click",function(){return!1})),function t(o){var n=r();e("#overlay").hide().css({width:n.pageWidth+"px",height:n.pageHeight+"px",opacity:100*a.overlayOpacity+"%"}).fadeIn(400);var g=0,s=[];if(a.downloads={},e("a").each(function(){if(this.href&&this.rel==o.rel){var t=e(this),n=a.showTitle?function e(t){var a=t.attr("title")||"";if(!a){var o=t.children("img:first-child");o.attr("title")?a=o.attr("title"):o.attr("alt")&&(a=o.attr("alt"))}return a.trim()}(t):"",r={html:"",text:""};if(a.showCaption){var l=t.parent().children("figcaption")[0];if(void 0!==l)r.html=l.innerHTML;else var r=function e(t){var a={html:"",text:""};if(t.parent().next(".gallery-caption").html()){var o=t.parent().next(".gallery-caption");a.html=o.html(),a.text=o.text()}else t.next(".wp-caption-text").html()&&(a.html=t.next(".wp-caption-text").html(),a.text=t.next(".wp-caption-text").text());return a.text=a.text.trim().replace("&#8217;","&#039;").replace("’","'").replace("…","..."),a}(t)}a.showTitle&&n.toLowerCase()==r.text.toLowerCase()&&(n=r.html,r.html="");var d=""!=n?'<span id="titleText">'+n+"</span>":"";d+=""!=n&&r.html?"<br />":"",d+=""!=r.html?'<span id="captionText">'+r.html+"</span>":"",(a.showDownload||t.attr("data-download"))&&(a.downloads[s.length]=t.attr("data-download")),s.push([this.href,d,s.length])}}),s.length>1){for(i=0;i<s.length;i++)for(j=s.length-1;j>i;j--)s[i][0]==s[j][0]&&s.splice(j,1);for(;s[g][0]!=o.href;)g++}a.imageArray=s;var c=l();d(c.y,c.x).show(),h(g),a.imageArray.length>1&&(e("#prevLink").on("click",function(){return h(0==a.activeImage?a.imageArray.length-1:a.activeImage-1),!1}),e("#nextLink").on("click",function(){return h(a.activeImage==a.imageArray.length-1?0:a.activeImage+1),!1}),e.fn.touchwipe&&e("#imageContainer").touchwipe({wipeLeft:function(){h(a.activeImage==a.imageArray.length-1?0:a.activeImage+1)},wipeRight:function(){h(0==a.activeImage?a.imageArray.length-1:a.activeImage-1)},min_move_x:20,preventDefaultEvents:!0}),a.slidehowSpeed&&e("#playPause").off("click").on("click",function(){return -1!=a.auto?(e(this).text(a.strings.play),clearTimeout(a.auto),a.auto=-1):(e(this).text(a.strings.pause),a.auto=setTimeout(function(){h(a.activeImage==a.imageArray.length-1?0:a.activeImage+1)},a.slidehowSpeed)),!1}),p())}(this),!1}if(e("#overlay").is(":visible")&&e(window).trigger("resize"),function e(t,a){var o,n,r;for(o=0,t=t.split("."),a=a.split("."),n=Math.min(t.length,a.length);o<n;o++)if(0!=(r=parseInt(t[o],10)-parseInt(a[o],10)))return r;return t.length-a.length}(e.fn.jquery,"1.7")>0)return e(this).on("click",o);return e(this).live("click",o);function n(e){a.resizeTimeout&&(clearTimeout(a.resizeTimeout),a.resizeTimeout=!1),a.resizeTimeout=setTimeout(function(){g()},50)}function r(){return{pageWidth:e(document).width(),pageHeight:e(document).height(),viewportWidth:e(window).width(),viewportHeight:e(window).height()-a.adminBarHeight}}function l(){var t=e(document).scrollTop();return a.adminBarHeight&&0===parseInt(e("#wpadminbar").css("top"),10)&&(t+=a.adminBarHeight),{x:e(document).scrollLeft(),y:t}}function d(t,o){return a.resizeSpeed>0?e("#lightbox").animate({top:t+"px",left:o+"px"},a.resizeSpeed,"linear"):e("#lightbox").css({top:t+"px",left:o+"px"})}function h(t){!0==a.video&&e("#lightboxVideo")[0].pause(),!1==a.inprogress&&(a.inprogress=!0,a.activeImage=t,e("#jqlb_loading").show(),e("#lightboxImage").hide(),e("#lightboxVideo").hide(),e("#hoverNav").hide(),e("#prevLink").hide(),e("#nextLink").hide(),function t(){var o=a.imageArray[a.activeImage][0];if(-1!=o.indexOf(".webm")||-1!=o.indexOf(".mp4")){e("#lightboxImage").hide(),e("#lightboxVideo").show();var n=e("#lightboxVideo");n.html('<source src="'+o+'" type="video/webm"/>'),n[0].load(),n[0].play(),a.video=!0,g();return}a.video=!1,a.imgPreloader=new Image,a.imgPreloader.onload=function(){e("#lightboxImage").attr("src",a.imageArray[a.activeImage][0]),function t(){var o=a.imageArray,n=a.strings,r=a.activeImage,l=o[r][2],d=a.showNumbers&&o.length>1?n.image+(r+1)+n.of+o.length:"";if(e("#imageDetails").css("opacity","100%"),""!=o[r][1]?e("#titleAndCaption").css("opacity","100%").html(o[r][1]):e("#titleAndCaption").empty(),a.showNumbers?e("#numberDisplay").css("opacity","100%").html(d):e("#numberDisplay").empty(),a.slidehowSpeed&&o.length>1){var h=-1===a.auto?n.play:n.pause;e("#playPause").css("opacity","100%").attr("href","#").text(h)}else e("#playPause").empty();if(a.showDownload||a.downloads[l]){var g=a.downloads[l]?a.downloads[l]:o[r][0];e("#downloadLink").css("opacity","100%").html(e("<a>").attr("href",g).attr("target","_blank").attr("download","").text(n.download))}else e("#downloadLink").empty();e("#downloadLink").position()}(),g(),a.imageArray.length>1?((preloadNextImage=new Image).src=a.imageArray[a.activeImage==a.imageArray.length-1?0:a.activeImage+1][0],(preloadPrevImage=new Image).src=a.imageArray[0==a.activeImage?a.imageArray.length-1:a.activeImage-1][0]):(a.imageArray.length-1>a.activeImage&&((preloadNextImage=new Image).src=a.imageArray[a.activeImage+1][0]),a.activeImage>0&&((preloadPrevImage=new Image).src=a.imageArray[a.activeImage-1][0]))},a.imgPreloader.src=a.imageArray[a.activeImage][0]}())}function g(){var t=r(),o=t.viewportWidth<t.pageWidth?t.pageWidth:t.viewportWidth;e("#overlay").css({width:o+"px",height:t.pageHeight+"px"});var n=t.viewportHeight-(e("#imageDataContainer").outerHeight(!0)+2*a.borderSize),h=t.viewportWidth-2*a.borderSize,g=0,c=0;if(!1==a.video){if(!a.imgPreloader)return;var g=a.imgPreloader.width,c=a.imgPreloader.height}else var g=.95*h,c=g*(9/16);if(a.fitToScreen){var m=n-a.marginSize,p=h-a.marginSize,v=1;c>m&&(v=m/c),g*=v,c*=v,v=1,g>p&&(v=p/g),g=Math.round(g*v),c=Math.round(c*v)}var u,$,f,w,y,_,x=l(),b=x.y+.5*n-.5*c,I=x.x;e("#lightboxImage").width(g).height(c),u=g,$=c,f=b,w=I,a.widthCurrent=e("#outerImageContainer").outerWidth(),a.heightCurrent=e("#outerImageContainer").outerHeight(),y=Math.max(300,u+2*a.borderSize),_=$+2*a.borderSize,d(f,w),e("#imageDataContainer").animate({width:y},a.resizeSpeed,"linear"),e("#outerImageContainer").animate({width:y,height:_},a.resizeSpeed,"linear",function(){e("#jqlb_loading").hide(),e("#titleAndCaption").css("opacity","100%"),a.showDownload&&e("#downloadLink").css("opacity","100%"),a.showNumbers&&e("#numberDisplay").css("opacity","100%"),a.slidehowSpeed&&e("#playPause").css("opacity","100%"),a.resizeSpeed>0?e("#imageDetails").animate({opacity:"100%"},"fast"):e("#imageDetails").css("opacity","100%"),!1==a.video?a.resizeSpeed>0?e("#lightboxImage").fadeIn("fast",function(){s()}):(e("#lightboxImage").show(),s()):e("#lightboxVideo").show(),a.inprogress=!1}),a.imageArray.length>1&&(e("#hoverNav").show(),e("#prevLink").show(),e("#nextLink").show()),e("#prevLink,#nextLink").height($)}function s(){-1!=a.auto&&(clearTimeout(a.auto),a.auto=setTimeout(function(){h(a.activeImage==a.imageArray.length-1?0:a.activeImage+1)},a.slidehowSpeed)),p()}function c(){v(),clearTimeout(a.auto),a.auto=-1,e("#lightbox").hide(),e("#overlay").fadeOut(),e("#lightboxVideo")[0].pause()}function m(e){var t=e.data.opts,a=e.keyCode,o=String.fromCharCode(a).toLowerCase();return"x"==o||"o"==o||"c"==o||27==a?c():"p"==o||37==a?(v(),h(0==t.activeImage?t.imageArray.length-1:t.activeImage-1)):("n"==o||39==a)&&(v(),h(t.activeImage==t.imageArray.length-1?0:t.activeImage+1)),!1}function p(){e(document).off("keydown").on("keydown",{opts:a},m)}function v(){e(document).off("keydown")}},e.fn.lightbox.defaults={showCaption:!1,showNumbers:!0,adminBarHeight:0,overlayOpacity:"80%",borderSize:10,imageArray:[],activeImage:null,inprogress:!1,widthCurrent:300,heightCurrent:300,showTitle:!0,imageClickClose:!0},e(document).ready(doLightBox)}(jQuery);function doLightBox(){var e,t,a="object"==typeof JQLBSettings,o=0;a&&JQLBSettings.slideshowSpeed&&(e=parseInt(JQLBSettings.slideshowSpeed)),a&&JQLBSettings.resizeSpeed&&(t=parseInt(JQLBSettings.resizeSpeed)),a&&JQLBSettings.marginSize&&(o=parseInt(JQLBSettings.marginSize)),jQuery('a[rel^="lightbox"]').lightbox({adminBarHeight:jQuery("#wpadminbar").height()||0,showNumbers:!a||"0"!=JQLBSettings.showNumbers,showCaption:!a||"0"!=JQLBSettings.showCaption,showTitle:!a||"0"!=JQLBSettings.showTitle,marginSize:a&&o?o:0,fitToScreen:!!a&&"1"==JQLBSettings.fitToScreen,resizeSpeed:a&&t>=0?t:400,slidehowSpeed:a&&e>=0?e:4e3,showDownload:!a||"0"!=JQLBSettings.showDownload,navbarOnTop:!a||"0"!=JQLBSettings.navbarOnTop,strings:a&&"string"==typeof JQLBSettings.prevLinkTitle?JQLBSettings:{prevLinkTitle:"previous image",nextLinkTitle:"next image",closeTitle:"close image gallery",image:"Image ",of:" of ",download:"Download",pause:"(pause slideshow)",play:"(play slideshow)"}})}